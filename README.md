---

## ภาพรวมโค้ดนี้คืออะไร?

โค้ดชุดนี้คือ **สมาร์ทคอนแทรกต์ระบบเลือกตั้งนักศึกษา** ที่เขียนด้วยภาษา Solidity สำหรับรันบน Ethereum Virtual Machine (EVM) หรือ Blockchain ที่รองรับ

โดยระบบนี้ช่วยให้:

* จัดการผู้สมัครเลือกตั้ง (Candidate)
* ลงทะเบียนผู้มีสิทธิ์เลือกตั้ง (Voter)
* โหวตผู้สมัคร
* ตรวจสอบสถานะและผลการเลือกตั้ง

---

## แนวคิดการออกแบบแบบ **Inheritance** คืออะไร?

Inheritance คือการสืบทอดคุณสมบัติหรือฟังก์ชันจากสัญญา (contract) หนึ่งไปยังอีกสัญญาหนึ่ง เพื่อแยกโค้ดตามหน้าที่ให้เป็นระบบระเบียบ ลดความซ้ำซ้อน และช่วยให้ง่ายต่อการบำรุงรักษา

โค้ดนี้แบ่งออกเป็น 3 ไฟล์หลัก ที่มีหน้าที่และรับผิดชอบแตกต่างกัน แต่ทำงานร่วมกันผ่านการสืบทอด (Inheritance) ดังนี้

---

## 1. **VoteChainDGT\_Config.sol**

ไฟล์นี้เก็บข้อมูลและค่าคงที่ (constant) ที่อาจมีการเปลี่ยนแปลงในอนาคต เช่น

* จำนวนสูงสุดของผู้สมัครและหมายเลขพรรค (MAX\_CANDIDATE\_ID, MAX\_PARTY\_NUMBER)
* สาขาวิชาที่อนุญาตให้ลงสมัคร (BRANCH\_DT, BRANCH\_DC)

### หน้าที่หลัก

* รวมค่าคงที่เพื่อให้ง่ายต่อการปรับเปลี่ยนโดยไม่ต้องแก้ไขไฟล์หลัก
* ช่วยลดการ hardcode ในไฟล์หลัก

---

## 2. **VoteChainDGT\_StudentIdValidator.sol**

ไฟล์นี้รวมฟังก์ชันสำหรับตรวจสอบความถูกต้องของรหัสนักศึกษา

### ฟังก์ชันหลัก

* `isValidStudentId(string memory studentId) public pure returns (bool)`

  ตรวจสอบว่า studentId เป็นไปตามรูปแบบที่กำหนด เช่น ต้องมี 8 ตัวอักษร ตัวแรกต้องเป็น B, M, หรือ D และมีการคำนวณ checksum ถูกต้อง

### หน้าที่หลัก

* แยกตรรกะการตรวจสอบรหัสออกจากฟังก์ชันหลัก
* เพิ่มความชัดเจนและสามารถนำไปใช้ซ้ำได้ในโค้ดอื่น

---

## 3. **VoteChainDGT.sol**

ไฟล์หลักที่รวบรวมฟังก์ชันการทำงานหลักทั้งหมดของระบบเลือกตั้ง

### Inheritance

* สืบทอดจากทั้ง

  * `VoteChainDGT_Config` (เพื่อใช้ค่าคงที่)
  * `VoteChainDGT_StudentIdValidator` (เพื่อใช้ฟังก์ชันตรวจสอบรหัสนักศึกษา)

### โครงสร้างข้อมูลสำคัญ

* `Candidate` - โครงสร้างข้อมูลผู้สมัคร
* `Voter` - โครงสร้างข้อมูลผู้ลงทะเบียนโหวต
* `PartyVoteResult` - โครงสร้างข้อมูลผลคะแนนแต่ละพรรค

### ตัวแปรสำคัญ

* จำนวนผู้สมัคร (`totalCandidates`)
* จำนวนผู้มีสิทธิ์เลือกตั้ง (`totalRegisteredVoters`)
* จำนวนโหวต (`totalVotesCast`, `totalRegisteredVotersWhoVoted`)
* แอดมิน (`adminAddresses`, `totalAdmins`)
* แผนที่เก็บข้อมูลผู้สมัครและผู้ลงทะเบียน (`mapping` ต่าง ๆ)

### ฟังก์ชันสำคัญ

* **Admin management**

  * `onlyAdmin` modifier ตรวจสอบสิทธิ์แอดมิน
  * `removeAdmin` ลบแอดมิน
  * `getAdmins` ดูรายชื่อแอดมิน
  * `setVotingPeriod` ตั้งระยะเวลาการเลือกตั้ง

* **Candidate management**

  * `addCandidate` เพิ่มผู้สมัคร (เช็คซ้ำ ซ้อน และตรวจสอบข้อมูล)
  * `removeCandidateByPartyNumber` ลบผู้สมัคร

* **Voter management**

  * `registerVoter` ลงทะเบียนผู้มีสิทธิ์เลือกตั้ง (เช็คซ้ำ ซ้อน และตรวจสอบข้อมูล)
  * `isAdmin` เช็คสิทธิ์แอดมิน (ใช้ในฟังก์ชัน)

* **Voting**

  * `vote` โหวตผู้สมัคร

* **ข้อมูลผลและสถานะ**

  * `getAllCandidates` ดูรายชื่อผู้สมัครทั้งหมด
  * `getCandidateByPartyNumber` ดูข้อมูลผู้สมัครเฉพาะพรรค
  * `getAllPartyVotes` ดูผลคะแนนแต่ละพรรค (ใช้ได้หลังเลือกตั้งเสร็จ)
  * `getWinner` หาผู้ชนะ (ใช้ได้หลังเลือกตั้งเสร็จ)
  * `getElectionSummary` สรุปข้อมูลสถิติ
  * `getStudentIdByAccount` ดึงรหัสนักศึกษาของผู้ลงทะเบียนโหวต

---

## สรุปความสัมพันธ์ไฟล์

| ไฟล์                                 | หน้าที่                                        | สืบทอด/ใช้กับไฟล์อื่น         |
| ------------------------------------ | ---------------------------------------------- | ----------------------------- |
| VoteChainDGT\_Config.sol             | เก็บค่าคงที่ เช่น จำนวนสูงสุด และสาขาที่อนุญาต | ถูกสืบทอดโดย VoteChainDGT.sol |
| VoteChainDGT\_StudentIdValidator.sol | ฟังก์ชันตรวจสอบรหัสนักศึกษา                    | ถูกสืบทอดโดย VoteChainDGT.sol |
| VoteChainDGT.sol                     | ฟังก์ชันและตัวแปรหลักของระบบเลือกตั้ง          | สืบทอด Config และ Validator   |

---

## แนวคิด Inheritance ในที่นี้

* โค้ดหลัก `VoteChainDGT.sol` ต้องการใช้ฟังก์ชันตรวจสอบรหัส และค่าคงที่ต่าง ๆ
* แทนที่จะเขียนโค้ดยาว ๆ ในไฟล์เดียว เราแยกหน้าที่เป็นโมดูลเล็ก ๆ (ไฟล์ Validator และ Config)
* แล้วสืบทอด (`is` inheritance) มาใช้ในไฟล์หลัก
* ทำให้โค้ดสะอาด ดูแลง่าย และแก้ไขค่าคงที่หรือฟังก์ชันตรวจสอบแยกได้โดยไม่กระทบโค้ดหลัก

---
